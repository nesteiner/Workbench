#+title: trace of making workbench

* Feature
- [ ] use websocket to send notification
- [ ] refresh token periodly
- [X] tabbar to controller routes, use *replacement* instead of push

* frontend
- [X] clipboard api
- [X] clipboard state
- [X] clipboard state in globalstate
- [X] check connection -- this need backend to accept check
  - [X] preload page
  - [X] setting page
- [X] æ¸…é™¤è®¾ç½®
- [X] __check connection__
- [ ] 401 exception
- [ ] refresh
- [ ] hint text
- [X] step by step
- [ ] pageview 
- [ ] use ScrollBar instead of SingleChildScrollView
- [ ] samba upload file
- [ ] statistics page of android
- [ ] drop ios features
- [ ] try watch statistics page
- [ ] *try global error handler*
** loading page
- [ ] when login, using loading page


* backend
- [X] transform Instant with kotlinx.serialization
- [X] build a simple demo




** DONE page cache 
- [ ] TabController
- [ ] NavigationRail with TabBarView ?
- [ ] æœ‰æ²¡æœ‰ä¸ NavigationRail æ­é…çš„ç»„ä»¶ï¼Œå°±åƒ TabBarViewé‚£æ ·
- [ ] ä¼šä¸ä¼šæ˜¯ keepalive ç”¨é”™äº†
- [ ] __trying to modify keepalive__
- [ ] use tabbarview, but no keepalive ?

* Scaffold
** Student
add @JsonIgnore to passwordHash
** WebSecurityConfigurer
order of filters

* Developing Notes
1. coroutineScope ä¼šåœ¨å†…éƒ¨å¯åŠ¨ä¸€ä¸ªå­åç¨‹æ¥æ‰§è¡Œé˜»å¡å¼çš„IOæ“ä½œ

** about JSON parse error in sealed class
æ‚¨å¥½ï¼Œè¿™æ˜¯ Bingã€‚æˆ‘çœ‹äº†æ‚¨çš„ä»£ç ï¼Œå‘ç°äº†ä¸€äº›é—®é¢˜ã€‚
é¦–å…ˆï¼Œæ‚¨çš„ =IconSerializer= ç±»æ²¡æœ‰å¿…è¦ç»§æ‰¿ =SealedClassSerializer=ï¼Œå› ä¸º =Icon= ç±»å·²ç»æ˜¯ä¸€ä¸ª =@Serializable= çš„å¯†å°ç±»ï¼Œæ‰€ä»¥å®ƒå·²ç»æœ‰äº†ä¸€ä¸ªé»˜è®¤çš„åºåˆ—åŒ–å™¨ã€‚æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨ `Icon.serializer()` æ¥è·å–å®ƒï¼Œæˆ–è€…çœç•¥ =@Serializable(with = IconSerializer::class)= æ³¨è§£ï¼Œè®©ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ã€‚
å…¶æ¬¡ï¼Œæ‚¨çš„ =SealedClassSerializer= ç±»çš„å®ç°æœ‰ä¸€äº›é—®é¢˜ã€‚æ‚¨çš„ =serialize= æ–¹æ³•å’Œ =deserialize= æ–¹æ³•éƒ½æ˜¯ç›´æ¥è°ƒç”¨ =serializer= çš„å¯¹åº”æ–¹æ³•ï¼Œæ²¡æœ‰åšä»»ä½•é¢å¤–çš„å¤„ç†ã€‚è¿™æ ·çš„è¯ï¼Œæ‚¨çš„åºåˆ—åŒ–å™¨å°±æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œè€Œä¸”å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå½“æ‚¨ä½¿ç”¨ `Json.decodeFromString<WrapperIcon>(jsonString)` æ—¶ï¼Œæ‚¨çš„ `IconSerializer` ä¼šè¢«ç”¨æ¥è§£æ `icon` å­—æ®µï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰æ­£ç¡®åœ°å¤„ç†å¯†å°ç±»çš„å¤šæ€æ€§ã€‚å®ƒä¼šæœŸæœ› `icon` å­—æ®µçš„å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› ä¸ºå¯†å°ç±»çš„é»˜è®¤åºåˆ—åŒ–æ ¼å¼æ˜¯ =[type, value]=ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‚¨ä¼šæ”¶åˆ°è¿™æ ·çš„é”™è¯¯ï¼š
#+begin_quote
kotlinx.serialization.json.internal.JsonDecodingException: Unexpected JSON token at offset 26: Expected start of the array '[', but had ' ' instead at path: $.icon
JSON input: {
"name": "hello",
"icon": {"type": "Word", "char": "h", "color": "#ffeccc68"}
}
#+end_quote

å¦‚æœæ‚¨æƒ³è¦è‡ªå®šä¹‰å¯†å°ç±»çš„åºåˆ—åŒ–æ ¼å¼ï¼Œæ‚¨éœ€è¦åœ¨ =serialize= æ–¹æ³•å’Œ =deserialize= æ–¹æ³•ä¸­æ·»åŠ ä¸€äº›é€»è¾‘ï¼Œæ¥æ ¹æ®ä¸åŒçš„å­ç±»ç±»å‹è¿›è¡Œç¼–ç å’Œè§£ç ã€‚æ‚¨å¯ä»¥å‚è€ƒè¿™ä¸ª[æ–‡æ¡£](^1^)ä¸­çš„ä¾‹å­ï¼Œäº†è§£å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„å¯†å°ç±»åºåˆ—åŒ–å™¨ã€‚

æˆ‘å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰å¸®åŠ©ã€‚å¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œæ¬¢è¿ç»§ç»­æé—®ã€‚ğŸ˜Š

æº: ä¸å¿…åº”çš„å¯¹è¯ï¼Œ 2023/11/21
(1) json - How to serialize/deserialize Kotlin sealed class? - Stack Overflow. https://stackoverflow.com/questions/50157468/how-to-serialize-deserialize-kotlin-sealed-class.
(2) JSON features - GitHub. https://github.com/Kotlin/kotlinx.serialization/blob/master/docs/json.md.
(3) JsonElement - Kotlin Programming Language. https://kotlinlang.org/api/kotlinx.serialization/kotlinx-serialization-json/kotlinx.serialization.json/-json-element/.
(4) Json - Kotlin Programming Language. https://kotlinlang.org/api/kotlinx.serialization/kotlinx-serialization-json/kotlinx.serialization.json/-json/.
(5) SealedClassSerializer - Kotlin Programming Language. https://kotlinlang.org/api/kotlinx.serialization/kotlinx-serialization-core/kotlinx.serialization/-sealed-class-serializer/.
(6) undefined. https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core.
(7) undefined. https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind.
(8) undefined. https://avatars.githubusercontent.com/u/1446536?v=4.
(9) undefined. https://github.com/Kotlin/kotlinx.serialization/blob/master/docs/json.md?raw=true.
(10) undefined. https://desktop.github.com.
(11) undefined. https://docs.github.com/articles/about-issue-and-pull-request-templates.
(12) undefined. https://github.com/Kotlin/kotlinx.serialization/raw/master/docs/json.md.
(13) undefined. https://www.json.org/json-en.html.
(14) undefined. https://kotlinlang.org/api/kotlinx.serialization/kotlinx-serialization-json/kotlinx.serialization.json/-json/index.html.


* TODO Demo Project
** Sidebar navigator
1. use controller
** nested route
1. use navigator key